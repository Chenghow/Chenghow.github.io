function initPostHelper(){KEEP.utils.postHelper={postPageContainerDom:document.querySelector(".post-page-container"),toggleShowTocBtn:document.querySelector(".toggle-show-toc"),toggleShowTocTabletBtn:document.querySelector(".toggle-show-toc-tablet"),toggleShowTocIcon:document.querySelector(".toggle-show-toc i"),mainContentDom:document.querySelector(".main-content"),postToolsDom:document.querySelector(".post-tools"),isShowToc:!1,initToggleToc(){this.toggleShowTocBtn&&this.toggleShowTocBtn.addEventListener("click",()=>{this.isShowToc=!this.isShowToc,KEEP.themeInfo.styleStatus.isShowToc=this.isShowToc,KEEP.setStyleStatus(),this.handleToggleToc(this.isShowToc)}),this.toggleShowTocTabletBtn&&this.toggleShowTocTabletBtn.addEventListener("click",()=>{const t=document.querySelector(".tablet-post-toc-mask"),e=t.querySelector(".tablet-post-toc");document.body.style.overflow="hidden",t.style.background="rgba(0, 0, 0, 0.25)",t.style.visibility="visible",e.style.transform="translateX(0)",t.addEventListener("click",()=>{document.body.style.overflow="",t.style.background="rgba(0, 0, 0, 0)",t.style.visibility="hidden",e.style.transform="translateX(-100%)"})})},handleToggleToc(t){t?(this.postPageContainerDom.classList.add("show-toc"),document.body.classList.add("has-toc")):(this.postPageContainerDom.classList.remove("show-toc"),document.body.classList.remove("has-toc")),setTimeout(()=>{this.setPostToolsLayout()},120)},hasToc(t){this.toggleShowTocBtn&&(this.toggleShowTocBtn.style.display="flex",this.isShowToc=t,this.handleToggleToc(t))},setPostToolsLayout(t){t=t||this.mainContentDom.getBoundingClientRect().width.toFixed(0);let e=5;window.innerWidth<=800&&(e=3);var o="left"===KEEP.theme_config.toc?.layout?"right":"left";this.postToolsDom.style.opacity="1",this.postToolsDom.style[o]=`calc((100vw - ${t}px) / 2 - ${e}rem)`},initSetPostToolsLeft(){setTimeout(()=>{this.setPostToolsLayout()},150),window.addEventListener("resize",()=>{this.setPostToolsLayout()})},goToComments(){const e=document.querySelector("#comments-anchor");[document.querySelector(".post-tools .go-to-comments"),document.querySelector(".exposed-tools-list .go-to-comments-tablet")].forEach(t=>{t&&e&&t.addEventListener("click",t=>{t.preventDefault();t=0===(t=window.scrollY)?-20:t,t=e.getBoundingClientRect().top+t;window.anime({targets:document.scrollingElement,duration:300,easing:"linear",scrollTop:t,complete:()=>{setTimeout(()=>{KEEP.utils.pageTopDom.classList.add("hide")},150)}})})})},watchPostCommentsCount(){const e=this.postToolsDom.querySelector(".post-comments-count");if(!e)return;const o=new MutationObserver(function(t){t.forEach(t=>{"childList"===t.type&&0<(t=Number(t.target.innerHTML))&&(e.style.display="flex",99<t)&&(e.innerHTML="99+",o.disconnect())})});o.observe(e,{attributes:!0,childList:!0})},setArticleAgingDays(){var t,e,o,s,n=document.querySelector(".post-content .post-aging-tips");n&&(t=n.querySelector(".days"),o=Date.now(),e=864e5*(n.dataset?.agingDays||30),s=((o=o-new Date(n.dataset.updateDate).getTime())/864e5).toFixed(0),e<=o)&&(t.innerHTML=s,n.style.display="block")},formatDatetime(t="YYYY-MM-DD hh:mm:ss",e=Date.now()){var o,e=new Date(e),s=((/(y+)/.test(t)||/(Y+)/.test(t))&&(t=t.replace(RegExp.$1,(""+e.getFullYear()).substr(4-RegExp.$1.length))),{"M+":e.getMonth()+1,"D+":e.getDate(),"d+":e.getDate(),"H+":e.getHours(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()});for(const n in s)new RegExp(`(${n})`).test(t)&&(o=""+s[n],t=t.replace(RegExp.$1,1===RegExp.$1.length?o:("00"+o).substr(o.length)));return t},resetPostUpdateDate(){var t=document.querySelector(".post-meta-info-container .post-update-date .pc"),e=new Date(t.dataset.updated).getTime(),o=KEEP.theme_config.post?.datetime_format||"YYYY-MM-DD HH:mm:ss";t.innerHTML=this.formatDatetime(o,e)}},KEEP.utils.postHelper.initSetPostToolsLeft(),KEEP.utils.postHelper.setArticleAgingDays(),KEEP.utils.postHelper.resetPostUpdateDate(),!0===KEEP.theme_config.toc?.enable&&KEEP.utils.postHelper.initToggleToc(),!0===KEEP.theme_config.comment?.enable&&(KEEP.utils.postHelper.goToComments(),KEEP.utils.postHelper.watchPostCommentsCount())}!0===KEEP.theme_config.pjax?.enable&&KEEP.utils?initPostHelper():window.addEventListener("DOMContentLoaded",initPostHelper);